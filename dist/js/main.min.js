/*
 griddit 2014-05-24 
*/
$(function(){function a(a,b){var c=$("<div>",{"class":"brick"});c.width(b);var d=$("<img />");d.attr("src",a.img_src),d.on("load",function(){var d=this.width/b;h=this.height/d,$(this).css({height:h}),c.append("<a href='"+a.permalink+"' target='_blank'>"+this.outerHTML+"</a>"),$("#grid").append(c[0].outerHTML)})}function b(b,c){posts=[];var f=$(window).innerWidth()/3;$.ajax({type:"get",url:"http://api.reddit.com/r/"+b+"/hot.json?&after="+d,beforeSend:function(){$("#searchterm").addClass("loadinggif")},complete:function(){$("#searchterm").removeClass("loadinggif")},success:function(b){var g=b.data.children;g.forEach(function(b){if(!b.data.is_self&&/\.(gif|jpg|jpeg|tiff|png)$/i.test(b.data.url)){var c={title:b.data.title,img_src:b.data.url,name:b.data.name,permalink:"http://reddit.com"+b.data.permalink};a(c,f)}d=b.data.name}),e=!0,c()}})}function c(){var a=new freewall("#grid");a.reset({selector:".brick",animate:!0,cellW:160,cellH:160,onResize:function(){a.fitWidth()}}),a.fitWidth(),$(window).trigger("resize")}var d="",e=!0,f="cats";$(window).scroll(function(){e&&$(window).scrollTop()>=$(document).height()-$(window).height()-50&&(e=!1,b(f,c))}),b(f,c),$("#searchterm").keypress(function(a){13==a.which&&($("#grid").empty(),d="",a.preventDefault(),f=$("#searchterm").val(),console.log(f),b(f,c))}),$("#help").click(function(){return $("#openModal").modal({fadeDuration:250}),!1})});